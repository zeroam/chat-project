# PROCHAT(v.0.0.1) Beta

## 소개

- AWS의 서버를 활용한 Node.js 기반의 채팅 웹 페이지
- Express 서버 패키지 사용
- MongoDB와 mongoose 패키지를 활용한 데이터 처리
- WS 프로토콜을 통한 실시간 데이터 전송(Socket.io 패키지 사용)



## 기능

- Redis에 세션값을 저장함으로써 서버 업데이트시 세션값 유실 방지
- 배포시 설정과 개발시 환경 분리
- dotenv 패키지를 활용해 비공개 값들은 .env 파일에 저장
- 웹 소켓을 통한 실시간으로 방의 생성, 방 인원의 변경 확인 가능
- 대기실에서 접속인원 확인 가능

- 방 생성 기능 및 방에 인원이 없을 시 2초 후 자동으로 방 삭제
- 방에 접속한 사람들끼리 채팅 및 이미지 파일 업로드 가능



## 진척상황

- 대기실
  - 대기실 네임스페이스의 connection 이벤트가 발생할 때마다 회원의 닉네임, 소켓 아이디를 값으로 하는 객체 리스트를 업데이트 하여 프론트 영역으로 데이터 전송
  - 받은 데이터를 기반으로 유저 목록 실시간 업데이트(UI 수정 예정)
- 방 생성
  - 방 생성시  mongoDB Document의 _id 값을 기반으로 방 생성
    - 패스워드가 있는 방에 접속시 prompt 창으로 비밀번호 입력하도록 설정
  - 방 네임스페이스에 _id 값으로 방 소켓 연결
  - 방 생성 이벤트 발생시 데이터를 받아와 타이틀, 공개/비공개 여부, 현재 인원, 최대 인원값을 기반으로 방 목록 생성
- 방 삭제
  - disconnection 이벤트 발생시 해당 소켓의 방에 있는 인원을 확인하여 0일시 방을 제거
- 채팅
  - 해당 방에 접속이나 나갈 때 기존 유저들에게 접속한 유저의 id를 제공하는 시스템 메시지 전송
  - 채팅 내역은 데이터베이스에 저장하여 기존에 참여하지 않았던 유저들도 채팅 내역 확인 가능
  - multer 패키지를 활용하여 파일 업로드
    - 파일 업로드시 소켓으로 이벤트를 발생시켜 img 태그 생성
    - 현재 img 파일 이외에도 다른 파일도 업로드 가능(버그) -> 정규표현식을 통해 업로드 파일의 형식 제한할 예정



## 구현 예정 기능들

- passport 패키지를 활용한 회원가입 및 로그인 기능
  - localLogin 뿐만아니라 카카오톡이나 페이스북과 같은 사이트와의 로그인 연동 예정
- 개인 socket id를 활용해 귓속말 기능 구현 예정
- 유저들이 대기실에서 간단한 게임들(지뢰찾기, 틱택토, 카드 뒤집기 등)을 할 수 있도록 자바스크립트로 구현 예정

